<!-- INDEX.HTML – Novembro Azul – Natter (MOBILE FULLSCREEN ESTÁVEL) -->
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NOVEMBRO AZUL - NATTER - Jogo da Saúde</title>

<style>
/* ====== Apenas patches de mobile/UX. Conteúdo original permanece. ====== */

/* Durante o jogo: sem scroll */
html.game-active, body.game-active { overflow: hidden !important; height: 100%; }

/* Some tudo que não é o canvas do jogo quando ele está rodando */
body.game-active #mainLogo,
body.game-active .header,
body.game-active header,
body.game-active #topText,
body.game-active #description,
body.game-active .subtitle,
body.game-active .title,
body.game-active .intro,
body.game-active [data-hide-on-game="true"] {
  display: none !important;
}

/* Canvas: deixamos o CSS livre; o tamanho é controlado por JS para evitar distorção */
#gameCanvas {
  display: block;
  margin: 0 auto;
  touch-action: none;
  -ms-touch-action: none;
  image-rendering: pixelated;
  image-rendering: crisp-edges;
}
</style>
</head>
<body>

<!-- ******* AQUI FICA TODO O SEU HTML ORIGINAL (TELA INICIAL, LOGO, FRASE, CANVAS, RANKING, ETC.) ******** -->
<!-- IMPORTANTE: mantenha os mesmos IDs: #startButton, #gameCanvas, #startScreen, #scoreDisplay, etc. -->
<!-- Este patch não altera nada disso; só faz ajustes quando o jogo começa. -->

<!-- =========================================================
     *** SEU CÓDIGO ORIGINAL VAI AQUI (copie do arquivo atual) ***
     ========================================================= -->

<script>
/* ======= Patch de compatibilidade mobile (sem tocar na lógica do jogo) ======= */
(function(){
  function viewportHeight() {
    return (window.visualViewport && window.visualViewport.height)
      ? Math.round(window.visualViewport.height)
      : window.innerHeight;
  }
  function enterGameMode() {
    document.documentElement.classList.add('game-active');
    document.body.classList.add('game-active');
  }
  function exitGameMode() {
    document.documentElement.classList.remove('game-active');
    document.body.classList.remove('game-active');
  }
  function setCanvasToViewport(canvas) {
    // Define tamanho interno do canvas = tamanho real da tela * DPR
    const dpr  = Math.max(1, Math.min(3, window.devicePixelRatio || 1));
    const cssW = window.innerWidth;
    const cssH = viewportHeight();

    // Corrige tamanho interno (sem distorcer o que é desenhado)
    canvas.width  = Math.floor(cssW * dpr);
    canvas.height = Math.floor(cssH * dpr);

    // Tamanho visual (preenche a tela)
    canvas.style.width  = cssW + 'px';
    canvas.style.height = cssH + 'px';

    const ctx = canvas.getContext('2d');
    if (ctx && ctx.setTransform) {
      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
      ctx.imageSmoothingEnabled = false; // preserva pixel-art
    }
  }
  function enableTouchJump(canvas) {
    function callJump(){ try{ if (typeof jump==='function' && !window.isJumping) jump(); }catch(e){} }
    const handle = (ev)=>{ ev.preventDefault(); callJump(); };
    canvas.addEventListener('touchstart', handle, {passive:false});
    canvas.addEventListener('pointerdown', (ev)=>{ if(ev.pointerType==='touch'){ handle(ev);} }, {passive:false});
    canvas.addEventListener('click', handle);
  }
  function tryFullscreen() {
    const el = document.documentElement;
    const req = el.requestFullscreen || el.webkitRequestFullscreen || el.msRequestFullscreen;
    try { req && req.call(el); } catch(e) {}
  }

  function hook() {
    const canvas = document.getElementById('gameCanvas');
    if (!canvas) return;

    // 1) Garante que, quando o jogo começar, ativamos o modo-app e dimensionamos certo
    if (typeof window.startGame === 'function' && !window.__patchedStart) {
      const originalStart = window.startGame;
      window.startGame = function(...args) {
        const r = originalStart.apply(this, args);
        setTimeout(() => {
          enterGameMode();
          setCanvasToViewport(canvas);
          tryFullscreen();
          enableTouchJump(canvas);
          // Redimensiona dinamicamente
          const onResize = () => setCanvasToViewport(canvas);
          window.addEventListener('resize', onResize);
          window.addEventListener('orientationchange', onResize);
        }, 60);
        return r;
      };
      window.__patchedStart = true;
    }

    // 2) Se voltar ao menu/over (canvas some), restaurar scroll/UI
    const obs = new MutationObserver(() => {
      const visible = getComputedStyle(canvas).display !== 'none';
      if (!visible) exitGameMode();
    });
    obs.observe(document.body, {subtree:true, childList:true, attributes:true});
  }

  if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', hook);
  else hook();
})();
</script>

<!-- =========================================================
     *** COLE AQUI O <script> ORIGINAL DO JOGO (sua lógica) ***
     ========================================================= -->

</body>
</html>
